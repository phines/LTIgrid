
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>psconstants_will</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-02-18"><meta name="DC.source" content="psconstants_will.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#9">values for electromechanical machine dynamics</a></li><li><a href="#10">governor elements</a></li><li><a href="#12">event-related definitions</a></li><li><a href="#13">relay matrix defines relays</a></li><li><a href="#14">area data</a></li><li><a href="#15">regulation ramp limits</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> C_out = psconstants
<span class="comment">% constants for a power system</span>
<span class="comment">%  These help us figure out where the data is in the data structure</span>

<span class="comment">% making C persistent allows us to call this function very quickly:</span>
<span class="keyword">persistent</span> C;

<span class="keyword">if</span> isempty(C)
</pre><pre class="codeinput"><span class="comment">	%% constants used to indicate the type of generator control used</span>
	C.PQ  = 1; <span class="comment">% when a generator output is constant P/Q</span>
	C.PV  = 2; <span class="comment">% when a generator is set to a voltage set point</span>
	C.REF = 3; <span class="comment">% use for an ideal voltage source</span>
    C.ISO = 4; <span class="comment">% isolated bus</span>
    C.PF  = 5; <span class="comment">% participation factor gen/bus</span>
</pre><pre class="codeinput"><span class="comment">	%% constants used for devices that may be controllable:</span>
	C.NO_CONTROL = 1;
	C.BINARY     = 2;
	C.CONTINUOUS = 3;
</pre><pre class="codeinput"><span class="comment">	%% constants for branches and circuit breaker status</span>
	C.OPEN   = 0;
	C.CLOSED = 1;
	C.F_OPEN = 2; <span class="comment">% from end open, to end closed</span>
	C.T_OPEN = 3; <span class="comment">% to end open, from end closed</span>
</pre><pre class="codeinput"><span class="comment">	%% other constants</span>
	C.EMTPY = -99999999; <span class="comment">% used to indicate empty or un-filled values</span>
    C.DEFAULT_VALUE = 1000; <span class="comment">% default value of a load ($/MVA)</span>
</pre><pre class="codeinput"><span class="comment">	%% bus data (same as MATPOWER, though loads are not used---remain zeros)</span>
	C.bu.id     = 1;
    C.bu.type   = 2;  <span class="comment">% use with caution---can be confusing</span>
    C.bu.Pd     = 3;  <span class="comment">% !!! DO NOT USE, calculated from shunt !!!</span>
    C.bu.Qd     = 4;  <span class="comment">% !!! DO NOT USE, calculated from shunt !!!</span>
    C.bu.Gs     = 5;  <span class="comment">% !!! DO NOT USE, calculated from shunt !!!</span>
    C.bu.Bs     = 6;  <span class="comment">% !!! DO NOT USE, calculated from shunt !!!</span>
    C.bu.area   = 7;  <span class="comment">% The area number for this bus</span>
	C.bu.Vmag   = 8;  <span class="comment">% rms magnitude, p.u.</span>
	C.bu.Vang   = 9;  <span class="comment">% bus angle in degrees</span>
	C.bu.baseKV = 10; <span class="comment">% base kV (voltage at 1.0 pu)</span>
    C.bu.zone   = 11; <span class="comment">% zone</span>
	C.bu.Vmax   = 12; <span class="comment">% minimum recommended voltage for this bus</span>
	C.bu.Vmin   = 13; <span class="comment">% maximum recommended voltage for this bus</span>
    C.bu.lam_P  = 14; <span class="comment">% sensitivity to injection</span>
    C.bu.lam_Q  = 15; <span class="comment">% sensitivity to injection</span>
    C.bu.mu_Vmax = 16; <span class="comment">% sensitivity to changes in limits</span>
    C.bu.mu_Vmin = 17; <span class="comment">% sensitivity to changes in limits</span>
	C.bu.locX   = 18;  <span class="comment">% location of the bus in the x dimension</span>
	C.bu.locY   = 19;  <span class="comment">% location of the bus in the y dimension</span>
    C.bu.theta  = 20;  <span class="comment">% the per unit theta at the bus</span>
    C.bu.time   = 21;
    <span class="comment">% synonyms</span>
    C.bu.locs   = [C.bu.locX C.bu.locY];

    <span class="comment">% column names</span>
    C.bu.col_names = {<span class="string">'ID'</span>,<span class="string">'type'</span>,<span class="string">'Pd'</span>,<span class="string">'Qd'</span>,<span class="string">'Gs'</span>,<span class="string">'Bs'</span>,<span class="string">'area'</span>,<span class="string">'Vmag'</span>,<span class="string">'Vang'</span>,<span class="string">'basekV'</span>,<span class="string">'zone'</span>,<span class="string">'Vmax'</span>,<span class="string">'Vmin'</span>,<span class="string">'lam_P'</span>,<span class="string">'lam_Q'</span>,<span class="string">'mu_Vx'</span>,<span class="string">'mu_Vn'</span>,<span class="string">'locX'</span>,<span class="string">'locY'</span>};

	C.bu.cols = 19; <span class="comment">% minimum number of columns</span>
	C.bus = C.bu; <span class="comment">% allows us to use C.bus or C.bu</span>
    <span class="comment">% default kv</span>
    C.bu.baseKV_default = 230;
</pre><pre class="codeinput"><span class="comment">	%% branch data (columns 1-17 are the same as MATPOWER)</span>
	C.br.from   = 1;  <span class="comment">% "from" end bus number</span>
	C.br.to     = 2;  <span class="comment">% "to" end bus number</span>
	C.br.R      = 3;  <span class="comment">% resistance (p.u.)</span>
	C.br.X      = 4;  <span class="comment">% line reactance (p.u.)</span>
	C.br.B      = 5;  <span class="comment">% line charging for the whole line (not B/2) (p.u.)</span>
	C.br.rateA  = 6;  <span class="comment">% normal line rating</span>
	C.br.rateB  = 7;  <span class="comment">% short-term line rating</span>
	C.br.rateC  = 8;  <span class="comment">% emergency line rating</span>
	C.br.tap    = 9;  <span class="comment">% tap ratio for transformer</span>
	C.br.shift  = 10; <span class="comment">% phase shift caused by transformer</span>
	C.br.status = 11; <span class="comment">% branch status (1, 0, C.F_OPEN, or C.T_OPEN)</span>
    C.br.Pf     = 12; <span class="comment">% branch from end real power flow</span>
    C.br.Qf     = 13; <span class="comment">% branch from end reactive power flow</span>
    C.br.Pt     = 14; <span class="comment">% branch to end real power flow</span>
    C.br.Qt     = 15; <span class="comment">% branch to end reactive power flow</span>
    C.br.mu_f   = 16; <span class="comment">% the sensitivity to changes to the from-end flow limit</span>
    C.br.mu_t   = 17; <span class="comment">% the sensitivity to changes to the to-end flow limit</span>
	C.br.Imag_f = 18; <span class="comment">% rms current (p.u.) on the from end of the branch</span>
	C.br.Imag_t = 19; <span class="comment">% rms current (p.u.) on the to end of the branch</span>
	C.br.switchable = 20; <span class="comment">% used to indicate that the branch is switchable</span>
    C.br.prob_fail = 21;  <span class="comment">% prob of one or more faults within this branch during a one hour period</span>
    C.br.type   = 22; <span class="comment">% branch type;</span>
    C.br.col_names = {<span class="string">'from'</span>,<span class="string">'to'</span>,<span class="string">'R'</span>,<span class="string">'X'</span>,<span class="string">'B'</span>,<span class="string">'rateA'</span>,<span class="string">'rateB'</span>,<span class="string">'rateC'</span>,<span class="string">'tap'</span>,<span class="string">'shift'</span>,<span class="string">'status'</span>};

	C.br.cols = 22;   <span class="comment">% min no. of cols for branch</span>
    C.br.temp=23;       <span class="comment">%temperature of the line</span>
    C.br.tempmax=24;  <span class="comment">%maximum temparture</span>
    C.br.time = 25;

	<span class="comment">% short cuts:</span>
	C.br.f = C.br.from;
	C.br.t = C.br.to;
	C.branch  = C.br;
    C.br.Imag = (C.br.Imag_f:C.br.Imag_t);
    C.br.rates = (C.br.rateA:C.br.rateC);
    <span class="comment">% branch type constants</span>
    C.br.type_tline = 0;
    C.br.type_twownd = 1; <span class="comment">% two winding transformer</span>
    C.br.type_threewnd = 2; <span class="comment">% one branch of a three-winding transformer</span>
    C.br.type_redtwownd = 3; <span class="comment">% ward reduced from two winding transformer</span>
    C.br.type_redthreewnd = 4; <span class="comment">% ward reduced from three winding transformer</span>
</pre><pre class="codeinput"><span class="comment">	%% generator data (cols 1-14 same as MATPOWER)</span>
	C.ge.bus    = 1; <span class="comment">% the location of the generator (bus number)</span>
	C.ge.Pg     = 2; <span class="comment">% the actual output of the generator</span>
	C.ge.Qg     = 3; <span class="comment">% the actual reactive output of the generator</span>
	C.ge.Qmax   = 4; <span class="comment">% max reactive power output</span>
	C.ge.Qmin   = 5; <span class="comment">% min reactive power output</span>
	C.ge.Vsp    = 6; <span class="comment">% set point for the generator if PV or REF</span>
    C.ge.mBase  = 7;<span class="comment">% machine MVA base</span>
	C.ge.status = 8; <span class="comment">% the generator status</span>
   	C.ge.Pmax   = 9; <span class="comment">% max real power output</span>
    C.ge.Pmin   = 10; <span class="comment">% min real power output</span>
    C.ge.mu_Pmax = 11; <span class="comment">% sensitivity</span>
    C.ge.mu_Pmin = 12; <span class="comment">% sensitivity</span>
    C.ge.mu_Qmax = 13; <span class="comment">% sensitivity</span>
    C.ge.mu_Qmin = 14; <span class="comment">% sensitivity</span>
	C.ge.type   = 15;  <span class="comment">% PV, PQ, PF, or REF %%"Type" used for gentpe (i.e. nuc, natgas, etc) in set_ramp_rates</span>
	C.ge.cost   = 16;  <span class="comment">% the marginal cost ($/MW) of power from this generator</span>
    C.ge.part_fact = 17; <span class="comment">% the participation factor of the generator (used only if type is PF or REF);</span>
    C.ge.ramp_rate_up = 18;   <span class="comment">% ramp rate up</span>
    C.ge.ramp_rate_down = 19; <span class="comment">% down ramp rate</span>
    C.ge.reg_ramp_up = 20;    <span class="comment">% regulation ramp rate up</span>
    C.ge.reg_ramp_down = 21;  <span class="comment">% regulation ramp rate down</span>
    C.ge.gen_type=22;         <span class="comment">% Type of generator: nuc, coal, etc.</span>
    C.ge.col_names = {<span class="string">'bus'</span>,<span class="string">'Pg'</span>,<span class="string">'Qg'</span>,<span class="string">'Qmax'</span>,<span class="string">'Qmin'</span>,<span class="string">'Vsp'</span>,<span class="string">'mBase'</span>,<span class="string">'status'</span>,<span class="string">'Pmax'</span>,<span class="string">'Pmin'</span>,<span class="keyword">...</span>
        <span class="string">'mu_Px'</span>,<span class="string">'mu_Pn'</span>,<span class="string">'mu_Qx'</span>,<span class="string">'mu_Qn'</span>,<span class="string">'type'</span>,<span class="string">'cost'</span>,<span class="string">'part_fact'</span>,<span class="string">'RRU'</span>,<span class="string">'RRD'</span>,<span class="string">'gen type'</span>};

	C.ge.cols = 22; <span class="comment">% min no. of cols</span>
    <span class="comment">% synonyms</span>
    C.gen  = C.ge;
    C.ge.P = C.ge.Pg;
    C.ge.Q = C.ge.Qg;
</pre><h2>values for electromechanical machine dynamics<a name="9"></a></h2><p>The notation and per unit methods are based on Bergen &amp; Vittal.</p><pre class="codeinput">    C.ma.gen  = 1;     <span class="comment">% gen bus location</span>
    C.ma.r    = 2;     <span class="comment">% coil-winding AC resistance</span>
    C.ma.Xd   = 3;     <span class="comment">% synchronous reactance (p.u.)</span>
    C.ma.Xdp  = 4;     <span class="comment">% transient reactance (p.u.)</span>
    C.ma.Xdpp = 5;     <span class="comment">% sub-transient reactance (p.u.)</span>
    C.ma.Xq   = 6;     <span class="comment">% Q-axis synchronous reactance (pu)</span>
    C.ma.Xqp  = 7;     <span class="comment">% Q-axis transient reactance (pu)</span>
    C.ma.Xqpp = 8;     <span class="comment">% Q-axis sub-transient reactance (pu)</span>
    C.ma.D    = 9;     <span class="comment">% damping constant (units?)</span>
    C.ma.M    = 10;    <span class="comment">% machine starting time (essentially inertia. pu using method in Bergen)</span>
    <span class="comment">% state variables</span>
    C.ma.Ea   = 11;    <span class="comment">% the open circuit voltage (magnitude) of the machine (field-induced voltage)</span>
    C.ma.Eap  = 12;    <span class="comment">% the transient internal voltage of the machine. (not always needed).</span>
    C.ma.Pm   = 13;    <span class="comment">% the mechancial power of the machine, after accounting for steady state damping (friction)</span>
    C.ma.Pm0  = 13;    <span class="comment">% also known as P_m^0 in Bergen. (system base)</span>
    C.ma.delta_m = 14; <span class="comment">% also known as delta_m in Bergen</span>
    C.ma.omega = 15;   <span class="comment">% the speed of the machine in radians per second</span>
    C.ma.P1    = 16;   <span class="comment">% Governor variable</span>
    C.ma.delta = 17;   <span class="comment">% rotor angle</span>
    C.ma.bus   = 18;   <span class="comment">% bus</span>
    C.ma.time  = 19;
    C.ma.label = 20;   <span class="comment">% machine name</span>
    C.ma.Tg   = 21;    <span class="comment">% Governor time constant</span>
    C.ma.Tt   = 22;    <span class="comment">% time constant</span>
    C.ma.k    = 23;    <span class="comment">% drop constant</span>
    C.ma.R    = 23;
    C.ma.Pc   = 24;    <span class="comment">%</span>
    C.ma.col_names = {<span class="string">'gen'</span>,<span class="string">'r'</span>,<span class="string">'Xd'</span>,<span class="string">'Xdp'</span>,<span class="string">'Xdpp'</span>,<span class="string">'Xq'</span>,<span class="string">'Xqp'</span>,<span class="string">'Xqpp'</span>,<span class="string">'D'</span>,<span class="string">'M''Ea'</span>,<span class="string">'Eap'</span>,<span class="string">'Pm'</span>,<span class="string">'Pm0'</span>,<span class="keyword">...</span>
        <span class="string">'delta_m'</span>,<span class="string">'omega'</span>,<span class="string">'P1'</span>,<span class="string">'delta'</span>,<span class="string">'bus'</span>,<span class="string">'time'</span>,<span class="string">'label'</span>,<span class="string">'Tg'</span>,<span class="string">'Tt'</span>,<span class="string">'k'</span>,<span class="string">'Pc'</span>};

    C.ma.cols = 23;
    <span class="comment">% synonyms</span>
    C.ma.Ea_mag = C.ma.Ea;
    C.mac = C.ma;
</pre><h2>governor elements<a name="10"></a></h2><pre class="codeinput">    <span class="comment">%gen type  R    Tg LCmax LCmin Pmax Pmin Pref</span>
    C.gov.gen   = 1;
    C.gov.type  = 2;
    C.gov.R     = 3;
    C.gov.Tg    = 4;
    C.gov.LCmax = 5;
    C.gov.LCmin = 6;
    C.gov.Pmax  = 7;
    C.gov.Pmin  = 8;
    C.gov.Pref  = 9;
</pre><pre class="codeinput"><span class="comment">	%% shunt elements (capacitors, loads, etc.)</span>
	<span class="comment">% A shunt essentially has a constant complex power and constant complex impedance elements</span>
	<span class="comment">%  in parallel between a bus and ground. "factor" or "status" can be used to scale the elements</span>
	C.sh.bus    = 1; <span class="comment">% the location (bus number) of the shunt element</span>
	C.sh.P      = 2; <span class="comment">% real power consumption (MW) at 1.0 p.u. voltage</span>
	C.sh.Q      = 3; <span class="comment">% reactive power consumption (MVAr) at 1.0 p.u. voltage</span>
	C.sh.frac_S = 4; <span class="comment">% fraction of the shunt (P/Q) that is constant complex power</span>
	C.sh.frac_Z = 5; <span class="comment">% fraction of the shunt (P/Q) that is constant complex impedance</span>
                     <span class="comment">% note that the remainder is constant current (if supported)</span>
    C.sh.frac_Y = 5; <span class="comment">% frac_Y is a synonym for frac_Z</span>
	C.sh.status = 6; <span class="comment">% indicates if the shunt is on or off</span>
	C.sh.factor = C.sh.status; <span class="comment">% status and factor have the same effect</span>
	<span class="comment">% use status with binary control or factor with continuous control</span>
	C.sh.type   = 7; <span class="comment">% indicates how this shunt is (or is not) controlled</span>
	C.sh.value  = 8; <span class="comment">% the relative value of this load ($/MVA), where MVA is abs(P+jQ)</span>
    C.sh.frac_E = 9; <span class="comment">% fraction of the shunt that should use an expontential load model P*Vmag^gamma;</span>
    C.sh.gamma  = 10;<span class="comment">% the exponent gamma in the equation above.</span>
	C.sh.cols   = 10; <span class="comment">% minimum number of columns</span>
    <span class="comment">% synonyms:</span>

	C.shunt     = C.sh; <span class="comment">% synonym</span>
    C.sh.col_names = {<span class="string">'bus'</span>,<span class="string">'P'</span>,<span class="string">'Q'</span>,<span class="string">'frac_S'</span>,<span class="string">'frac_Z'</span>,<span class="string">'status'</span>,<span class="string">'type'</span>,<span class="string">'value'</span>};
</pre><h2>event-related definitions<a name="12"></a></h2><pre class="codeinput">    <span class="comment">% event types</span>
    C.event.start  = 0;
    C.event.end    = 1;
    C.event.finish = C.event.end; <span class="comment">% same as end</span>
    C.event.fault  = 2; <span class="comment">% three phase to ground fault by default</span>
    C.event.clear_fault = 3; <span class="comment">% clear a fault</span>
    C.event.trip_branch  = 4;
    C.event.close_branch = 5;
    C.event.trip_bus     = 6;

    <span class="comment">% columns</span>
    C.event.time       = 1; <span class="comment">% event time in seconds</span>
    C.event.type       = 2; <span class="comment">% type (start and finish are required)</span>
    C.event.bus_loc    = 3; <span class="comment">% the bus at which the event takes place</span>
    C.event.branch_loc = 4; <span class="comment">% the branch at which the event takes place</span>
    C.event.gen_loc    = 5; <span class="comment">% the gen at which the event takes place</span>
    C.event.shunt_loc  = 6; <span class="comment">% the shunt at which the event takes place</span>
    C.event.cols = 6;
    <span class="comment">% synonym</span>
    C.ev = C.event;
</pre><h2>relay matrix defines relays<a name="13"></a></h2><p>relay types:  oc: overcurrent  dist: distance  uv: undervoltage  ufls: underfrequency load shedding</p><pre class="codeinput">    C.relay.oc   = 1;
    C.relay.dist = 2;
    C.relay.uv   = 3;
    C.relay.ufls = 4;
    <span class="comment">% relay columns</span>
    C.relay.type       = 1; <span class="comment">%</span>
    C.relay.setting1   = 2; <span class="comment">% setting 1</span>
    C.relay.setting2   = 3; <span class="comment">% setting 2</span>
    C.relay.threshold  = 4; <span class="comment">% the relay threshold. When &gt;state, relay trips</span>
    C.relay.state_a    = 5; <span class="comment">% the analog state of the relay</span>
    C.relay.state      = 5; <span class="comment">% the analog state of the relay</span>
    C.relay.state_b    = 6; <span class="comment">% the binary state of the relay (open(0)/closed(1));</span>
    C.relay.bus_loc    = 7; <span class="comment">% the bus location for the relay</span>
    C.relay.branch_loc = 8; <span class="comment">% the branch location for the relay</span>
    C.relay.gen_loc    = 9; <span class="comment">% the gen location for the relay</span>
    C.relay.shunt_loc  = 10; <span class="comment">% the shunt location for the relay</span>
    C.relay.cols = 9;
    <span class="comment">% syn</span>
    C.re = C.relay;
</pre><h2>area data<a name="14"></a></h2><pre class="codeinput">    C.ar.K = 1; <span class="comment">% the gain factor for area control</span>
    C.ar.B = 2; <span class="comment">% the frequency bias multiplier</span>
    C.ar.R = 3; <span class="comment">% reguating characteristic</span>
</pre><h2>regulation ramp limits<a name="15"></a></h2><pre class="codeinput">    C.reg.up   = 1; <span class="comment">% regulation ramp rate up for each 5 minute period</span>
    C.reg.down = 2; <span class="comment">% regualtion ramp rate down for each 5 minute period</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

C_out = C;
</pre><pre class="codeoutput">
ans = 

               PQ: 1
               PV: 2
              REF: 3
              ISO: 4
               PF: 5
       NO_CONTROL: 1
           BINARY: 2
       CONTINUOUS: 3
             OPEN: 0
           CLOSED: 1
           F_OPEN: 2
           T_OPEN: 3
            EMTPY: -99999999
    DEFAULT_VALUE: 1000
               bu: [1x1 struct]
              bus: [1x1 struct]
               br: [1x1 struct]
           branch: [1x1 struct]
               ge: [1x1 struct]
              gen: [1x1 struct]
               ma: [1x1 struct]
              mac: [1x1 struct]
              gov: [1x1 struct]
               sh: [1x1 struct]
            shunt: [1x1 struct]
            event: [1x1 struct]
               ev: [1x1 struct]
            relay: [1x1 struct]
               re: [1x1 struct]
               ar: [1x1 struct]
              reg: [1x1 struct]

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
function C_out = psconstants
% constants for a power system
%  These help us figure out where the data is in the data structure

% making C persistent allows us to call this function very quickly:
persistent C;

if isempty(C)
	%% constants used to indicate the type of generator control used
	C.PQ  = 1; % when a generator output is constant P/Q
	C.PV  = 2; % when a generator is set to a voltage set point
	C.REF = 3; % use for an ideal voltage source
    C.ISO = 4; % isolated bus
    C.PF  = 5; % participation factor gen/bus
	
	%% constants used for devices that may be controllable:
	C.NO_CONTROL = 1;
	C.BINARY     = 2;
	C.CONTINUOUS = 3;
	
	%% constants for branches and circuit breaker status
	C.OPEN   = 0;
	C.CLOSED = 1;
	C.F_OPEN = 2; % from end open, to end closed
	C.T_OPEN = 3; % to end open, from end closed
	
	%% other constants
	C.EMTPY = -99999999; % used to indicate empty or un-filled values
    C.DEFAULT_VALUE = 1000; % default value of a load ($/MVA)
	
	%% bus data (same as MATPOWER, though loads are not usedREPLACE_WITH_DASH_DASH-remain zeros)
	C.bu.id     = 1;
    C.bu.type   = 2;  % use with cautionREPLACE_WITH_DASH_DASH-can be confusing
    C.bu.Pd     = 3;  % !!! DO NOT USE, calculated from shunt !!!
    C.bu.Qd     = 4;  % !!! DO NOT USE, calculated from shunt !!!
    C.bu.Gs     = 5;  % !!! DO NOT USE, calculated from shunt !!!
    C.bu.Bs     = 6;  % !!! DO NOT USE, calculated from shunt !!!
    C.bu.area   = 7;  % The area number for this bus
	C.bu.Vmag   = 8;  % rms magnitude, p.u.
	C.bu.Vang   = 9;  % bus angle in degrees
	C.bu.baseKV = 10; % base kV (voltage at 1.0 pu)
    C.bu.zone   = 11; % zone
	C.bu.Vmax   = 12; % minimum recommended voltage for this bus 
	C.bu.Vmin   = 13; % maximum recommended voltage for this bus
    C.bu.lam_P  = 14; % sensitivity to injection
    C.bu.lam_Q  = 15; % sensitivity to injection
    C.bu.mu_Vmax = 16; % sensitivity to changes in limits
    C.bu.mu_Vmin = 17; % sensitivity to changes in limits
	C.bu.locX   = 18;  % location of the bus in the x dimension
	C.bu.locY   = 19;  % location of the bus in the y dimension
    C.bu.theta  = 20;  % the per unit theta at the bus
    C.bu.time   = 21;
    % synonyms
    C.bu.locs   = [C.bu.locX C.bu.locY];
    
    % column names
    C.bu.col_names = {'ID','type','Pd','Qd','Gs','Bs','area','Vmag','Vang','basekV','zone','Vmax','Vmin','lam_P','lam_Q','mu_Vx','mu_Vn','locX','locY'};

	C.bu.cols = 19; % minimum number of columns
	C.bus = C.bu; % allows us to use C.bus or C.bu
    % default kv
    C.bu.baseKV_default = 230;

	%% branch data (columns 1-17 are the same as MATPOWER)
	C.br.from   = 1;  % "from" end bus number
	C.br.to     = 2;  % "to" end bus number
	C.br.R      = 3;  % resistance (p.u.)
	C.br.X      = 4;  % line reactance (p.u.)
	C.br.B      = 5;  % line charging for the whole line (not B/2) (p.u.)
	C.br.rateA  = 6;  % normal line rating
	C.br.rateB  = 7;  % short-term line rating
	C.br.rateC  = 8;  % emergency line rating
	C.br.tap    = 9;  % tap ratio for transformer
	C.br.shift  = 10; % phase shift caused by transformer
	C.br.status = 11; % branch status (1, 0, C.F_OPEN, or C.T_OPEN)
    C.br.Pf     = 12; % branch from end real power flow
    C.br.Qf     = 13; % branch from end reactive power flow
    C.br.Pt     = 14; % branch to end real power flow
    C.br.Qt     = 15; % branch to end reactive power flow
    C.br.mu_f   = 16; % the sensitivity to changes to the from-end flow limit
    C.br.mu_t   = 17; % the sensitivity to changes to the to-end flow limit
	C.br.Imag_f = 18; % rms current (p.u.) on the from end of the branch
	C.br.Imag_t = 19; % rms current (p.u.) on the to end of the branch
	C.br.switchable = 20; % used to indicate that the branch is switchable
    C.br.prob_fail = 21;  % prob of one or more faults within this branch during a one hour period
    C.br.type   = 22; % branch type;
    C.br.col_names = {'from','to','R','X','B','rateA','rateB','rateC','tap','shift','status'};

	C.br.cols = 22;   % min no. of cols for branch
    C.br.temp=23;       %temperature of the line
    C.br.tempmax=24;  %maximum temparture
    C.br.time = 25;

	% short cuts:
	C.br.f = C.br.from;
	C.br.t = C.br.to;
	C.branch  = C.br;
    C.br.Imag = (C.br.Imag_f:C.br.Imag_t);
    C.br.rates = (C.br.rateA:C.br.rateC);
    % branch type constants
    C.br.type_tline = 0;
    C.br.type_twownd = 1; % two winding transformer
    C.br.type_threewnd = 2; % one branch of a three-winding transformer
    C.br.type_redtwownd = 3; % ward reduced from two winding transformer
    C.br.type_redthreewnd = 4; % ward reduced from three winding transformer

	%% generator data (cols 1-14 same as MATPOWER)
	C.ge.bus    = 1; % the location of the generator (bus number)
	C.ge.Pg     = 2; % the actual output of the generator
	C.ge.Qg     = 3; % the actual reactive output of the generator
	C.ge.Qmax   = 4; % max reactive power output
	C.ge.Qmin   = 5; % min reactive power output
	C.ge.Vsp    = 6; % set point for the generator if PV or REF
    C.ge.mBase  = 7;% machine MVA base
	C.ge.status = 8; % the generator status
   	C.ge.Pmax   = 9; % max real power output
    C.ge.Pmin   = 10; % min real power output
    C.ge.mu_Pmax = 11; % sensitivity
    C.ge.mu_Pmin = 12; % sensitivity
    C.ge.mu_Qmax = 13; % sensitivity
    C.ge.mu_Qmin = 14; % sensitivity
	C.ge.type   = 15;  % PV, PQ, PF, or REF %%"Type" used for gentpe (i.e. nuc, natgas, etc) in set_ramp_rates
	C.ge.cost   = 16;  % the marginal cost ($/MW) of power from this generator
    C.ge.part_fact = 17; % the participation factor of the generator (used only if type is PF or REF);
    C.ge.ramp_rate_up = 18;   % ramp rate up
    C.ge.ramp_rate_down = 19; % down ramp rate
    C.ge.reg_ramp_up = 20;    % regulation ramp rate up
    C.ge.reg_ramp_down = 21;  % regulation ramp rate down
    C.ge.gen_type=22;         % Type of generator: nuc, coal, etc.
    C.ge.col_names = {'bus','Pg','Qg','Qmax','Qmin','Vsp','mBase','status','Pmax','Pmin',...
        'mu_Px','mu_Pn','mu_Qx','mu_Qn','type','cost','part_fact','RRU','RRD','gen type'};

	C.ge.cols = 22; % min no. of cols
    % synonyms
    C.gen  = C.ge;
    C.ge.P = C.ge.Pg;
    C.ge.Q = C.ge.Qg;
    
    %% values for electromechanical machine dynamics
    % The notation and per unit methods are based on Bergen & Vittal.
    C.ma.gen  = 1;     % gen bus location
    C.ma.r    = 2;     % coil-winding AC resistance
    C.ma.Xd   = 3;     % synchronous reactance (p.u.)
    C.ma.Xdp  = 4;     % transient reactance (p.u.)
    C.ma.Xdpp = 5;     % sub-transient reactance (p.u.)
    C.ma.Xq   = 6;     % Q-axis synchronous reactance (pu)
    C.ma.Xqp  = 7;     % Q-axis transient reactance (pu)
    C.ma.Xqpp = 8;     % Q-axis sub-transient reactance (pu)
    C.ma.D    = 9;     % damping constant (units?)
    C.ma.M    = 10;    % machine starting time (essentially inertia. pu using method in Bergen)
    % state variables
    C.ma.Ea   = 11;    % the open circuit voltage (magnitude) of the machine (field-induced voltage)
    C.ma.Eap  = 12;    % the transient internal voltage of the machine. (not always needed).
    C.ma.Pm   = 13;    % the mechancial power of the machine, after accounting for steady state damping (friction)
    C.ma.Pm0  = 13;    % also known as P_m^0 in Bergen. (system base)
    C.ma.delta_m = 14; % also known as delta_m in Bergen
    C.ma.omega = 15;   % the speed of the machine in radians per second
    C.ma.P1    = 16;   % Governor variable
    C.ma.delta = 17;   % rotor angle
    C.ma.bus   = 18;   % bus
    C.ma.time  = 19;
    C.ma.label = 20;   % machine name
    C.ma.Tg   = 21;    % Governor time constant
    C.ma.Tt   = 22;    % time constant
    C.ma.k    = 23;    % drop constant
    C.ma.R    = 23;
    C.ma.Pc   = 24;    % 
    C.ma.col_names = {'gen','r','Xd','Xdp','Xdpp','Xq','Xqp','Xqpp','D','M''Ea','Eap','Pm','Pm0',...
        'delta_m','omega','P1','delta','bus','time','label','Tg','Tt','k','Pc'};
    
    C.ma.cols = 23;
    % synonyms
    C.ma.Ea_mag = C.ma.Ea;
    C.mac = C.ma;
   
    
    %% governor elements
    %gen type  R    Tg LCmax LCmin Pmax Pmin Pref
    C.gov.gen   = 1;
    C.gov.type  = 2;
    C.gov.R     = 3;
    C.gov.Tg    = 4;
    C.gov.LCmax = 5;
    C.gov.LCmin = 6;
    C.gov.Pmax  = 7;
    C.gov.Pmin  = 8;
    C.gov.Pref  = 9;

	%% shunt elements (capacitors, loads, etc.)
	% A shunt essentially has a constant complex power and constant complex impedance elements
	%  in parallel between a bus and ground. "factor" or "status" can be used to scale the elements
	C.sh.bus    = 1; % the location (bus number) of the shunt element
	C.sh.P      = 2; % real power consumption (MW) at 1.0 p.u. voltage
	C.sh.Q      = 3; % reactive power consumption (MVAr) at 1.0 p.u. voltage
	C.sh.frac_S = 4; % fraction of the shunt (P/Q) that is constant complex power
	C.sh.frac_Z = 5; % fraction of the shunt (P/Q) that is constant complex impedance
                     % note that the remainder is constant current (if supported)
    C.sh.frac_Y = 5; % frac_Y is a synonym for frac_Z
	C.sh.status = 6; % indicates if the shunt is on or off
	C.sh.factor = C.sh.status; % status and factor have the same effect
	% use status with binary control or factor with continuous control
	C.sh.type   = 7; % indicates how this shunt is (or is not) controlled
	C.sh.value  = 8; % the relative value of this load ($/MVA), where MVA is abs(P+jQ)
    C.sh.frac_E = 9; % fraction of the shunt that should use an expontential load model P*Vmag^gamma;
    C.sh.gamma  = 10;% the exponent gamma in the equation above.
	C.sh.cols   = 10; % minimum number of columns
    % synonyms:
    
	C.shunt     = C.sh; % synonym
    C.sh.col_names = {'bus','P','Q','frac_S','frac_Z','status','type','value'};
    
    %% event-related definitions

    % event types 
    C.event.start  = 0;
    C.event.end    = 1;
    C.event.finish = C.event.end; % same as end
    C.event.fault  = 2; % three phase to ground fault by default
    C.event.clear_fault = 3; % clear a fault
    C.event.trip_branch  = 4;
    C.event.close_branch = 5;
    C.event.trip_bus     = 6;
    
    % columns 
    C.event.time       = 1; % event time in seconds
    C.event.type       = 2; % type (start and finish are required)
    C.event.bus_loc    = 3; % the bus at which the event takes place
    C.event.branch_loc = 4; % the branch at which the event takes place
    C.event.gen_loc    = 5; % the gen at which the event takes place
    C.event.shunt_loc  = 6; % the shunt at which the event takes place
    C.event.cols = 6;
    % synonym
    C.ev = C.event;
    
    %% relay matrix defines relays
    % relay types:
    %  oc: overcurrent
    %  dist: distance
    %  uv: undervoltage
    %  ufls: underfrequency load shedding
    C.relay.oc   = 1;
    C.relay.dist = 2;
    C.relay.uv   = 3;
    C.relay.ufls = 4;
    % relay columns
    C.relay.type       = 1; % 
    C.relay.setting1   = 2; % setting 1
    C.relay.setting2   = 3; % setting 2
    C.relay.threshold  = 4; % the relay threshold. When >state, relay trips
    C.relay.state_a    = 5; % the analog state of the relay
    C.relay.state      = 5; % the analog state of the relay
    C.relay.state_b    = 6; % the binary state of the relay (open(0)/closed(1));
    C.relay.bus_loc    = 7; % the bus location for the relay
    C.relay.branch_loc = 8; % the branch location for the relay
    C.relay.gen_loc    = 9; % the gen location for the relay
    C.relay.shunt_loc  = 10; % the shunt location for the relay
    C.relay.cols = 9;
    % syn
    C.re = C.relay;
    
    %% area data
    C.ar.K = 1; % the gain factor for area control
    C.ar.B = 2; % the frequency bias multiplier
    C.ar.R = 3; % reguating characteristic
    
    %% regulation ramp limits
    C.reg.up   = 1; % regulation ramp rate up for each 5 minute period
    C.reg.down = 2; % regualtion ramp rate down for each 5 minute period
    
end

C_out = C;

##### SOURCE END #####
--></body></html>